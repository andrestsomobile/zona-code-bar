package nacionalizacion.control;import nacionalizacion.form.*;import nacionalizacion.entity.*;import db.*;import java.util.Collection;import java.math.BigDecimal;import java.sql.SQLException;/******************************************************** ***** CLASE GENERADA CON generator V3.0 By pablito *******/public class gstnacionalizacion extends GstTabla {	public gstnacionalizacion() {		db = new beanConnector();		this.classEntidad = nacionalizacion.class;	}	public gstnacionalizacion(beanConnector db) {		this.db = db;		this.classEntidad = nacionalizacion.class;	}	public Collection getlistanacionalizacion() {		String consulta = " SELECT * FROM nacionalizacion";		return getLista(consulta);	}	public Collection getlistanacionalizacion(String start, String param) {		start = start == null ? "0" : start;		param = param == null ? "" : param;		String consulta = " SELECT * FROM nacionalizacion where " + getTextoBusquedaResumen(param) + "order by naccodsx desc" + "  limit " + this.maxfilas + " offset  " + (Integer.parseInt(start) * this.maxfilas);		return getLista(consulta);	}	public int getTotalPaginaslistanacionalizacion(String param) {		param = param == null ? "" : param;		String consulta = " SELECT count(1) FROM nacionalizacion where  " + getTextoBusquedaResumen(param);		return getPaginas(consulta);	}	public boolean crearnacionalizacion(String nacempresa, String nacfecha, String nacingreso, String nacestado, String nacdeclaracion, String nacfechadeclaracion, String nacfechaingresobodega, String nacpaginainicial, String nacpaginafinal, String nacdosia, String nacobservacines, String nactipo,			String nacpesoneto, String nacpesobruto, String nacfob, String nacconsec, String nacconseczfp) throws SQLException {		String insert = "INSERT INTO nacionalizacion (nacempresa,nacfecha,nacingreso,nacestado, " + "nacdeclaracion, nacfechadeclaracion ,nacfechaingresobodega ,nacpaginainicial "				+ ",nacpaginafinal ,nacdosia, nacobservaciones , nactipo, nacpesoneto, nacpesobruto, nacfob, nacconsec, nacconseczfp ) VALUES ("				+ (nacempresa == null ? "NULL" : "'" + nacempresa + "'")				+ ","				+ (nacfecha == null ? "NULL" : "'" + nacfecha + "'")				+ ","				+ (nacingreso == null ? "NULL" : "'" + nacingreso + "'")				+ ","				+ (nacestado == null ? "NULL" : "'" + nacestado + "'")				+ ","				+ (nacdeclaracion == null ? "NULL" : "'" + nacdeclaracion + "'")				+ ","				+ (nacfechadeclaracion == null ? "NULL" : "'" + nacfechadeclaracion + "'")				+ ","				+ (nacfechaingresobodega == null ? "NULL" : "'" + nacfechaingresobodega + "'")				+ ","				+ (nacpaginainicial == null ? "NULL" : "'" + nacpaginainicial + "'")				+ ","				+ (nacpaginafinal == null ? "NULL" : "'" + nacpaginafinal + "'")				+ ","				+ (nacdosia == null ? "NULL" : "'" + nacdosia + "'")				+ ","				+ (nacobservacines == null ? "NULL" : "'" + nacobservacines + "'")				+ ","				+ (nactipo == null ? "NULL" : "'" + nactipo + "'")				+ ","				+ (nacpesoneto == null ? "NULL" : "'" + nacpesoneto + "'")				+ ","				+ (nacpesobruto == null ? "NULL" : "'" + nacpesobruto + "'")				+ ","				+ (nacfob == null ? "NULL" : "'" + nacfob + "'")				+ ","				+ (nacconsec == null ? "NULL" : "'" + nacconsec + "'") + "," + (nacconseczfp == null ? "NULL" : "'" + nacconseczfp + "'")				+ ")";		int resp = db.executeUpdate(insert);		return resp == 0 ? false : true;	}	public nacionalizacion getnacionalizacion(String naccodsx) {		String cad = "SELECT * FROM nacionalizacion WHERE naccodsx='" + naccodsx + "'";		return (nacionalizacion) getEntidad(cad);	}	public nacionalizacion getnacionalizacion(String nacempresa, String nacfecha, String nacingreso) {		String cad = "SELECT * FROM nacionalizacion WHERE nacempresa=" + nacempresa + " and nacfecha='" + nacfecha + "' and nacingreso=" + nacingreso;		return (nacionalizacion) getEntidad(cad);	}	public boolean updatenacionalizacion(nacionalizacion entity) throws SQLException {		String cad = " update nacionalizacion set  " + " nacempresa = " + (entity.getnacempresa() == null ? "NULL" : "'" + entity.getnacempresa() + "'") + "," + " nacfecha = " + (entity.getnacfecha() == null ? "NULL" : "'" + entity.getnacfecha() + "'") + "," + " nacingreso = "				+ (entity.getnacingreso() == null ? "NULL" : "'" + entity.getnacingreso() + "'") + "," + " nacestado = " + (entity.getnacestado() == null ? "NULL" : "'" + entity.getnacestado() + "'") + "," +				" nacdeclaracion = " + (entity.getnacdeclaracion() == null ? "NULL" : "'" + entity.getnacdeclaracion() + "'") + "," + " nacfechadeclaracion = " + (entity.getnacfechadeclaracion() == null ? "NULL" : "'" + entity.getnacfechadeclaracion() + "'") + "," + " nacfechaingresobodega = "				+ (entity.getnacfechaingresobodega() == null ? "NULL" : "'" + entity.getnacfechaingresobodega() + "'") + "," + " nacpaginainicial= " + (entity.getnacpaginainicial() == null ? "NULL" : "'" + entity.getnacpaginainicial() + "'") + "," + " nacpaginafinal = "				+ (entity.getnacpaginafinal() == null ? "NULL" : "'" + entity.getnacpaginafinal() + "'") + "," + " nacdosia = " + (entity.getnacdosia() == null ? "NULL" : "'" + entity.getnacdosia() + "'") + "," + " nacobservaciones = "				+ (entity.getnacobservaciones() == null ? "NULL" : "'" + entity.getnacobservaciones() + "'") + "," + " nactipo = " + (entity.getNactipo() == null ? "NULL" : "'" + entity.getNactipo() + "'") + "," + " nacpesoneto = "				+ (entity.getNacpesoneto() == null ? "NULL" : "'" + entity.getNacpesoneto() + "'") + "," + " nacpesobruto = " + (entity.getNacpesobruto() == null ? "NULL" : "'" + entity.getNacpesobruto() + "'") + "," + " nacfob  = "				+ (entity.getNacfob() == null ? "NULL" : "'" + entity.getNacfob() + "'") + "," + " nacconsec = " + (entity.getNacconsec() == null ? "NULL" : "'" + entity.getNacconsec() + "'") + "," + " nacconseczfp  = "				+ (entity.getNacconseczfp() == null ? "NULL" : "'" + entity.getNacconseczfp() + "'") + " where naccodsx = " + entity.getnaccodsx();		int resp = db.executeUpdate(cad);		return resp == 0 ? false : true;	}	public boolean updatenacionalizacion(nacionalizacionForm entity) throws SQLException {		String cad = " update nacionalizacion set  " + " nacempresa = " + (entity.getnacempresa() == null ? "NULL" : "'" + entity.getnacempresa() + "'") + "," + " nacfecha = " + (entity.getnacfecha() == null ? "NULL" : "'" + entity.getnacfecha() + "'") + "," + " nacingreso = "				+ (entity.getnacingreso() == null ? "NULL" : "'" + entity.getnacingreso() + "'") + "," + " nacestado = " + (entity.getnacestado() == null ? "NULL" : "'" + entity.getnacestado() + "'") + "," + " nacdeclaracion = "				+ (entity.getNacdeclaracion() == null ? "NULL" : "'" + entity.getNacdeclaracion() + "'") + "," + " nacfechadeclaracion = " + (entity.getNacfechadeclaracion() == null ? "NULL" : "'" + entity.getNacfechadeclaracion() + "'") + "," + " nacfechaingresobodega = "				+ (entity.getNacfechaingresobodega() == null ? "NULL" : "'" + entity.getNacfechaingresobodega() + "'") + "," + " nacpaginainicial= " + (entity.getNacpaginainicial() == null ? "NULL" : "'" + entity.getNacpaginainicial() + "'") + "," + " nacpaginafinal = "				+ (entity.getNacpaginafinal() == null ? "NULL" : "'" + entity.getNacpaginafinal() + "'") + "," + " nacdosia = " + (entity.getNacdosia() == null ? "NULL" : "'" + entity.getNacdosia() + "'") + "," + " nacobservaciones = "				+ (entity.getNacobservaciones() == null ? "NULL" : "'" + entity.getNacobservaciones() + "'") + "," + " nactipo = " + (entity.getNactipo() == null ? "NULL" : "'" + entity.getNactipo() + "'") + "," + " nacpesoneto = "				+ (entity.getNacpesoneto() == null ? "NULL" : "'" + entity.getNacpesoneto() + "'") + "," + " nacpesobruto = " + (entity.getNacpesobruto() == null ? "NULL" : "'" + entity.getNacpesobruto() + "'") + "," + " nacfob  = "				+ (entity.getNacfob() == null ? "NULL" : "'" + entity.getNacfob() + "'") + "," + " nacconsec = " + (entity.getNacconsec() == null ? "NULL" : "'" + entity.getNacconsec() + "'") + "," + " nacconseczfp  = "				+ (entity.getNacconseczfp() == null ? "NULL" : "'" + entity.getNacconseczfp() + "'") + " where naccodsx = " + entity.getnaccodsx();		int resp = db.executeUpdate(cad);		return resp == 0 ? false : true;	}	public boolean eliminar(String naccodsx) throws SQLException {		String elim = " delete from nacionalizacion where naccodsx = '" + naccodsx + "'";		int r = db.executeUpdate(elim);		return r == 0 ? false : true;	}	public Collection getlistanacionalizacionByIngreso(String nacingreso) {		String consulta = " SELECT * FROM nacionalizacion where nacingreso=" + nacingreso;		return getLista(consulta);	}	public BigDecimal getSaldoReservadoNacionalizacion(String procodsx) {		String cad = "select sum(nadcantidad) from nacionalizacion as nac, nacionalizacion_detalle as nacd, entrada " + " where nac.naccodsx = nacd.nadcodnac and nacestado='TRAMITE' and nacd.nadentrada = entcodsx and entcodproducto = " + procodsx;		String resp = getCampo(cad);		return resp == null || resp.equals("") ? BigDecimal.ZERO : new BigDecimal(resp);	}	public int getNumeroPackingsNacionalizacion(String naccodsx) {		String consulta = "select count(1) from nacionalizacion, nacionalizacion_detalle, packing_detalle_posicion " + " where naccodsx = nadcodnac and nadcodsx = packpnacdetalle and naccodsx = " + naccodsx;		return getConteo(consulta);	}	public String getTotalUnidades(String naccodsx) {		String cad = "SELECT sum(nadcantidad) from nacionalizacion_detalle where nadcodnac = " + naccodsx;		return getCampo(cad);	}		public boolean tieneAverias(String naccodsx) {		 String cad = "select count(1)  from nacionalizacion " +		 " inner join nacionalizacion_detalle on nadcodnac = naccodsx " +		 " inner join averia_nacdet on avnnacdet_or  =  nadcodsx " +		 " where naccodsx = " + naccodsx;		 String r = getCampo(cad);		 return (r==null || (r!=null && r.equals("0")))? false: true;	}		public boolean crea_auditoria (String codsx, String accion, String usuario, String antes, String despues)  throws SQLException {		String cad = "INSERT INTO auditorianacionalizacion(aunaccodsx, aunacaccion, aunacfecha, aunacusuario, aunacnaccodsx, aunacantes, aunacdespues) VALUES ( "				+ "DEFAULT, "				+ "'" + accion + "', "				+ "CURRENT_TIMESTAMP, "				+ "'" + usuario + "', "				+ "'" + codsx + "', "				+ "'" + antes + "', "				+ "'" + despues + "') ";		int resp = db.executeUpdate(cad);		return resp == 0 ? false : true;	}	}