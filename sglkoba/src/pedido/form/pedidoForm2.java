package pedido.form;   import java.util.Collection;import java.util.Iterator;import javax.servlet.http.HttpServletRequest; import maestro.control.gstciudad;import maestro.control.gstcliente;import maestro.control.gstdepartamento;import maestro.control.gstsucursal;import maestro.entity.ciudad;import maestro.entity.cliente;import maestro.entity.departamento;import maestro.entity.sucursal;   import org.apache.struts.action.ActionErrors;    import org.apache.struts.action.ActionForm;   import org.apache.struts.action.ActionMapping;   import pedido.control.*;   import pedido.entity.*;import org.apache.struts.action.ActionMessage; import org.omg.PortableInterceptor.SUCCESSFUL; /** * CLASE GENERADA CON generator V3.0 By pablito****** */public class pedidoForm2  extends ActionForm { 
private String pedcodsx;private String pedcompania;private String pednumpedido;private String pedordencompra;private String pedguia;private String pedfechasistema;private String pedfecha;private String pedfechavenc;private String pedfechacita;private String pedhoracita;private String pedcliente;private String pedsucursal;private String peddireccion;private String pedciudad;private String peddepartamento;private String pedobservaciones;private String pedfactura;private String pedestado;private String pedsubtotal;private String pediva;private String peddescuento;private String pedtotal;/** * @uml.property  name="pedtipo" */private String pedtipo; private String opcion; /** * @uml.property  name="clidesc" */private String clidesc; /** * @uml.property  name="sucdesc" */private String sucdesc; /** * @uml.property  name="ciudesc" */private String ciudesc; /** * @uml.property  name="depdesc" */private String depdesc;  /** * @uml.property  name="pedpicking" */private String pedpicking;  /** * @uml.property  name="pedpesoneto" */private String pedpesoneto;/** * @uml.property  name="pedpesobruto" */private String pedpesobruto;  /** * @uml.property  name="pedhora" */private String pedhora;/** * @uml.property  name="pedzona" */private String pedzona;/** * @uml.property  name="pedcausal_hit" */private String pedcausal_hit;
  /** * @uml.property  name="pedporc_iva" */private String pedporc_iva; public void setopcion(String newopcion) { this.opcion = newopcion; }
 public String getopcion() { return this.opcion; }
public String getpedcodsx() {return pedcodsx;}public String getpedcompania() {return pedcompania;}public String getpednumpedido() {return pednumpedido;}public String getpedordencompra() {return pedordencompra;}public String getpedguia() {return pedguia;}public String getpedfechasistema() {return pedfechasistema;}public String getpedfecha() {return pedfecha;}public String getpedfechavenc() {return pedfechavenc;}public String getpedfechacita() {return pedfechacita;}public String getpedhoracita() {return pedhoracita;}public String getpedcliente() {return pedcliente;}public String getpedsucursal() {return pedsucursal;}public String getpeddireccion() {return peddireccion;}public String getpedciudad() {return pedciudad;}public String getpeddepartamento() {return peddepartamento;}public String getpedobservaciones() {return pedobservaciones;}public String getpedfactura() {return pedfactura;}public String getpedestado() {return pedestado;}public String getpedsubtotal() {return pedsubtotal;}public String getpediva() {return pediva;}public String getpeddescuento() {return peddescuento;}public String getpedtotal() {return pedtotal;}public void setpedcodsx(String new_pedcodsx) {this.pedcodsx =  new_pedcodsx;}public void setpedcompania(String new_pedcompania) {this.pedcompania =  new_pedcompania;}public void setpednumpedido(String new_pednumpedido) {this.pednumpedido =  new_pednumpedido;}public void setpedordencompra(String new_pedordencompra) {this.pedordencompra =  new_pedordencompra;}public void setpedguia(String new_pedguia) {this.pedguia =  new_pedguia;}public void setpedfechasistema(String new_pedfechasistema) {this.pedfechasistema =  new_pedfechasistema;}public void setpedfecha(String new_pedfecha) {this.pedfecha =  new_pedfecha;}public void setpedfechavenc(String new_pedfechavenc) {this.pedfechavenc =  new_pedfechavenc;}public void setpedfechacita(String new_pedfechacita) {this.pedfechacita =  new_pedfechacita;}public void setpedhoracita(String new_pedhoracita) {this.pedhoracita =  new_pedhoracita;}public void setpedcliente(String new_pedcliente) {this.pedcliente =  new_pedcliente;}public void setpedsucursal(String new_pedsucursal) {this.pedsucursal =  new_pedsucursal;}public void setpeddireccion(String new_peddireccion) {this.peddireccion =  new_peddireccion;}public void setpedciudad(String new_pedciudad) {this.pedciudad =  new_pedciudad;}public void setpeddepartamento(String new_peddepartamento) {this.peddepartamento =  new_peddepartamento;}public void setpedobservaciones(String new_pedobservaciones) {this.pedobservaciones =  new_pedobservaciones;}public void setpedfactura(String new_pedfactura) {this.pedfactura =  new_pedfactura;}public void setpedestado(String new_pedestado) {this.pedestado =  new_pedestado;}public void setpedsubtotal(String new_pedsubtotal) {this.pedsubtotal =  new_pedsubtotal;}public void setpediva(String new_pediva) {this.pediva =  new_pediva;}public void setpeddescuento(String new_peddescuento) {this.peddescuento =  new_peddescuento;}public void setpedtotal(String new_pedtotal) {this.pedtotal =  new_pedtotal;} public void reset(ActionMapping mapping, HttpServletRequest request) {  	}  public ActionErrors validate(ActionMapping mapping, HttpServletRequest request) { 
ActionErrors errors = new ActionErrors(); 
 gstpedido gpedido= new gstpedido(); 
 opcion = opcion==null ? "crear" : opcion; 
 if(opcion.equals("set") || opcion.equals("delete") || opcion.equals("activar")  || opcion.equals("fijar_factura") ) return null; 
 if(opcion.equals("crear")   ) { 
 //@todo COMPLETAR EL CREAR, SOLO LLAVES UNICAS O REPETIDAS 
} 
pedpicking = pedpicking!=null && pedpicking.equals("") ? null : pedpicking;
//valido campos requeridos:   if(pedcompania.equals("")) errors.add("pedcompania", new ActionMessage("La empresa no puede ser vacio", false) );     if(pednumpedido.equals("")) errors.add("pednumpedido", new ActionMessage("El Numero de pedido no puede ser vacio", false) );     if(pedordencompra.equals("")) errors.add("pedordencompra", new ActionMessage("La orden de compra no puede ser vacio", false) );     if(pedguia.equals("")) errors.add("pedguia", new ActionMessage("La guia del pedido no puede ser vacio", false) );     if(pedfecha.equals("")) errors.add("pedfecha", new ActionMessage("El Fecha del pedido no puede ser vacio", false) );     if(pedfechavenc.equals("")) errors.add("pedfechavenc", new ActionMessage("El Fecha vencimiento no puede ser vacio", false) );     if(pedcliente.equals("")) errors.add("pedcliente", new ActionMessage("El Cliente no puede ser vacio", false) );     if(pedsucursal.equals("")) errors.add("pedsucursal", new ActionMessage("LA sucursal no puede ser vacio", false) );     if(peddireccion.equals("")) errors.add("peddireccion", new ActionMessage("La direccion no puede ser vacio", false) );     if(pedciudad.equals("")) errors.add("pedciudad", new ActionMessage("La ciudad no puede ser vacio", false) );     if(peddepartamento.equals("")) errors.add("peddepartamento", new ActionMessage("El Departamento no puede ser vacio", false) );     if(pedtipo==null ) errors.add("pedtipo", new ActionMessage("El Tipo de pedido no puede ser vacio", false) );
   if(pedcausal_hit.equals("") ) errors.add("pedcausal_hit", new ActionMessage("El Causal HIT de pedido no puede ser vacio", false) );   if(pedporc_iva.equals("") ) errors.add("pedporc_iva", new ActionMessage("El Porcentaje de IVA del pedido no puede ser vacio", false) );   //reviso que si la guia del pedido ya existe para esta compania, el cliente debe ser el mismo que en el primer pedido:  if(!pedcompania.equals("") && !pedguia.equals("")) {   Collection pedidos = gpedido.getlistapedidoByGuia(pedcompania, pedguia); //pedidos by guia / cliente / empresa   if(!pedidos.isEmpty()) {	   //saco el primer pedido	   Iterator ite = pedidos.iterator();	  if(ite.hasNext()) {		  pedido ped = (pedido)ite.next();		  String guia = ped.getpedguia();		  String cli = ped.getpedcliente();		  String suc = ped.getpedsucursal();		  		  //si las guias son las mismas, el cliente debe ser el mismo:		  if(guia.equals(pedguia)) {			  //si son diferentes saco error:			  if(!cli.equals(pedcliente)) {				  cliente cl = new gstcliente().getcliente(cli);				  errors.add( "pedguia", new ActionMessage("EL NUMERO DE GUIA " + guia + " YA ESTA ASOCIADO AL PEDIDO " +				  		" CON CONSECUTIVO "+ ped.getpedcodsx() + ", POR LO TANTO, EL CLIENTE DEBE SER EL MISMO " +				  		" EN TODOS LOS PEDIDOS (CLIENTE " + cl.getclinombre() + " - " + cl.getclicodsx() + ")"						  , false));			  }else {				  //el cliente es el mismo, valido que sea la misma sucursal				  if(!suc.equals(pedsucursal)) {					  sucursal su = new gstsucursal().getsucursal( suc);					  cliente cl = new gstcliente().getcliente(cli);					  errors.add( "pedsucursal", new ActionMessage("EL NUMERO DE GUIA " + guia + " YA ESTA ASOCIADO AL PEDIDO " +					  		" CON CONSECUTIVO "+ ped.getpedcodsx() + ", POR LO TANTO, EL CLIENTE DEBE SER EL MISMO " +					  		" EN TODOS LOS PEDIDOS (CLIENTE " + cl.getclinombre() + " - " + cl.getclicodsx() + ")" + 					  		" y la sucursal " + su.getsucnombre() + " ubicada en la direccion:" + su.getsucdireccion()							  , false));				  }			  }			  			  		  }	  }	      }  }    	//miro si va a finalizarlo		pedido ped = gpedido.getpedido(this.getpedcodsx());	if( ped!=null && ped.getpedestado().equals("TRAMITE") && this.getpedestado().equals("FINALIZADO")) {				if(this.getpedfactura().equals("")) {						  errors.add( "pedfactura", new ActionMessage("UN PEDIDO SE PUEDE FINALIZAR SI TIENE EL NUMERO DE FACTURA"						  , false));			  pedestado="TRAMITE";		}			}	         if(!errors.isEmpty()) errors.add("general", new ActionMessage("No se han podido guardar los datos, revise", false) );  
 return errors; 
 } 

 public void llenar (pedido entity ) { 
 

this.pedcodsx =  entity.getpedcodsx(); this.pedcompania =  entity.getpedcompania(); this.pednumpedido =  entity.getpednumpedido(); this.pedordencompra =  entity.getpedordencompra(); this.pedguia =  entity.getpedguia(); this.pedfechasistema =  entity.getpedfechasistema(); this.pedfecha =  entity.getpedfecha(); this.pedfechavenc =  entity.getpedfechavenc(); this.pedfechacita =  entity.getpedfechacita(); this.pedhoracita =  entity.getpedhoracita(); this.pedcliente =  entity.getpedcliente(); this.pedsucursal =  entity.getpedsucursal(); this.peddireccion =  entity.getpeddireccion(); this.pedciudad =  entity.getpedciudad(); this.peddepartamento =  entity.getpeddepartamento(); this.pedobservaciones =  entity.getpedobservaciones(); this.pedfactura =  entity.getpedfactura(); this.pedestado =  entity.getpedestado(); this.pedsubtotal =  entity.getpedsubtotal(); this.pediva =  entity.getpediva(); this.peddescuento =  entity.getpeddescuento(); this.pedtotal =  entity.getpedtotal();this.pedtipo = entity.getpedtipo();this.pedpicking = entity.getPedpicking();this.pedpesoneto = entity.getPedpesoneto();this.pedpesobruto = entity.getPedpesobruto();//lleno los parametros de cliente, sucursal y departamento aqui:cliente cli = new gstcliente().getcliente(pedcliente);if(cli!=null) this.clidesc = cli.getclinombre();System.out.println("aqui boy");sucursal suc = new gstsucursal().getsuccodcursal(this.pedsucursal);this.sucdesc = suc.getsucnombre();System.out.println("\n---->0"+this.sucdesc);if(suc==null) suc=new gstsucursal().getsucursal(this.pedsucursal);//System.out.println("---->1"+this.sucdesc);if(suc!=null) this.sucdesc = suc.getsucnombre();System.out.println("\n---->2"+this.sucdesc);departamento dep = new gstdepartamento().getdepartamento( peddepartamento);if(dep!=null) depdesc = dep.getdepnombre();ciudad ciu = new gstciudad().getciudad( pedciudad);if(ciu!=null) ciudesc = ciu.getciunombre();this.pedhora = entity.getPedhora();this.pedzona = entity.getPedzona();this.pedcausal_hit = entity.getPedcausal_hit();this.pedporc_iva = entity.getPedporc_iva(); }/** * @return * @uml.property  name="clidesc" */public String getClidesc() {	return clidesc;}/** * @param clidesc * @uml.property  name="clidesc" */public void setClidesc(String clidesc) {	this.clidesc = clidesc;}/** * @return * @uml.property  name="ciudesc" */public String getCiudesc() {	return ciudesc;}/** * @param ciudesc * @uml.property  name="ciudesc" */public void setCiudesc(String ciudesc) {	this.ciudesc = ciudesc;}/** * @return * @uml.property  name="depdesc" */public String getDepdesc() {	return depdesc;}/** * @param depdesc * @uml.property  name="depdesc" */public void setDepdesc(String depdesc) {	this.depdesc = depdesc;}/** * @return * @uml.property  name="sucdesc" */public String getSucdesc() {	return sucdesc;}/** * @param sucdesc * @uml.property  name="sucdesc" */public void setSucdesc(String sucdesc) {	this.sucdesc = sucdesc;}/** * @return * @uml.property  name="pedtipo" */public String getPedtipo() {	return pedtipo;}/** * @param pedtipo * @uml.property  name="pedtipo" */public void setPedtipo(String pedtipo) {	this.pedtipo = pedtipo;}/** * @return * @uml.property  name="pedpicking" */public String getPedpicking() {	return pedpicking;}/** * @param pedpicking * @uml.property  name="pedpicking" */public void setPedpicking(String pedpicking) {	this.pedpicking = pedpicking;}/** * @return * @uml.property  name="pedpesobruto" */public String getPedpesobruto() {	return pedpesobruto;}/** * @param pedpesobruto * @uml.property  name="pedpesobruto" */public void setPedpesobruto(String pedpesobruto) {	this.pedpesobruto = pedpesobruto;}/** * @return * @uml.property  name="pedpesoneto" */public String getPedpesoneto() {	return pedpesoneto;}/** * @param pedpesoneto * @uml.property  name="pedpesoneto" */public void setPedpesoneto(String pedpesoneto) {	this.pedpesoneto = pedpesoneto;}/** * @return * @uml.property  name="pedcausal_hit" */public String getPedcausal_hit() {	return pedcausal_hit;}/** * @param pedcausal_hit * @uml.property  name="pedcausal_hit" */public void setPedcausal_hit(String pedcausal_hit) {	this.pedcausal_hit = pedcausal_hit;}/** * @return * @uml.property  name="pedhora" */public String getPedhora() {	return pedhora;}/** * @param pedhora * @uml.property  name="pedhora" */public void setPedhora(String pedhora) {	this.pedhora = pedhora;}/** * @return * @uml.property  name="pedzona" */public String getPedzona() {	return pedzona;}/** * @param pedzona * @uml.property  name="pedzona" */public void setPedzona(String pedzona) {	this.pedzona = pedzona;}/** * @return * @uml.property  name="pedporc_iva" */public String getPedporc_iva() {	return pedporc_iva;}/** * @param porc_iva * @uml.property  name="pedporc_iva" */public void setPedporc_iva(String porc_iva) {	this.pedporc_iva = porc_iva;}
}
