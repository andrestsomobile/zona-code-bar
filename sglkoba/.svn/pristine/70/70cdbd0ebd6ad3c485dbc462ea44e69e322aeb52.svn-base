package averias.control;import java.sql.SQLException;import java.util.Collection;import util.Listado;import averias.entity.averia;import averias.entity.averia_padre;import averias.form.averia_padreForm;import db.GstTabla;import db.beanConnector;public class gstaveria_padre extends GstTabla {	public gstaveria_padre() {		db = new beanConnector();		this.classEntidad = averia_padre.class;	}	public gstaveria_padre(beanConnector db) {		this.db = db;		this.classEntidad = averia_padre.class;	}	public Collection getlistaaveria_padre() {		String consulta = " SELECT * FROM averia_padre";		return getLista(consulta);	}	public Collection getlistaaveria_padre(String start, String param) {		start = start == null ? "0" : start;		param = param == null ? "" : param;		String consulta = " SELECT * FROM averia_padre where " + getTextoBusquedaResumen(param) + " order by avpcodsx desc " + "  limit " + this.maxfilas + " offset  " + (Integer.parseInt(start) * this.maxfilas);		return getLista(consulta);	}	public int getTotalPaginaslistaaveria_padre(String param) {		param = param == null ? "" : param;		String consulta = " SELECT count(1) FROM averia_padre where  " + getTextoBusquedaResumen(param);		return getPaginas(consulta);	}	public int crearaveria_padre(String avpcompania, String avpfecha, String avpingreso, String avpestado) throws SQLException {		String insert = "INSERT INTO averia_padre (avpcompania,avpfecha,avpingreso,avpestado) VALUES ("				+ (avpcompania == null ? "NULL" : "'" + avpcompania + "'") + ","				+ (avpfecha == null ? "NULL" : "'" + avpfecha + "'") + ","				+ (avpingreso == null ? "NULL" : "'" + avpingreso + "'") + ","				+ (avpestado == null ? "NULL" : "'" + avpestado + "'") +  ") returning avpcodsx";			return getConteo(insert);	}	public averia_padre getaveria_padre(String avpcodsx) {		String cad = "SELECT * FROM averia_padre WHERE avpcodsx='" + avpcodsx + "'";		return (averia_padre) getEntidad(cad);	}	public boolean updateaveria_padre(averia_padre entity) throws SQLException {		String cad = " update averia_padre set  " 				+ " avpcompania = " + (entity.getavpcompania() == null ? "NULL" : "'" + entity.getavpcompania() + "'") + "," 				+ " avpfecha = " + (entity.getavpfecha() == null ? "NULL" : "'" + entity.getavpfecha() + "'") + "," 				+ " avpingreso = " + (entity.getavpingreso() == null ? "NULL" : "'" + entity.getavpingreso() + "'") + "," 				+ " avpestado = " + (entity.getavpestado() == null ? "NULL" : "'" + entity.getavpestado() + "'")  				+ " where avpcodsx = " + entity.getavpcodsx();		int resp = db.executeUpdate(cad);		return resp == 0 ? false : true;	}	public boolean updateaveria_padre(averia_padreForm entity) throws SQLException {		String cad = " update averia_padre set  " 				+ " avpcompania = " + (entity.getavpcompania() == null ? "NULL" : "'" + entity.getavpcompania() + "'") + "," 				+ " avpfecha = " + (entity.getavpfecha() == null ? "NULL" : "'" + entity.getavpfecha() + "'") + "," 				+ " avpingreso = " + (entity.getavpingreso() == null ? "NULL" : "'" + entity.getavpingreso() + "'") + "," 				+ " avpestado = " + (entity.getavpestado() == null ? "NULL" : "'" + entity.getavpestado() + "'") 				+ " where avpcodsx = " + entity.getavpcodsx();		int resp = db.executeUpdate(cad);		return resp == 0 ? false : true;	}	public boolean eliminar(String avpcodsx) throws SQLException {		String elim = " delete from averia_padre where avpcodsx = '" + avpcodsx + "'";		int r = db.executeUpdate(elim);		return r == 0 ? false : true;	}		public boolean tieneDetalles(String avpcodsx) {		 String cad = "select count(1)  from averia where avecodaveriapadre ="+ avpcodsx;		 String r = getCampo(cad);		 return (r==null || (r!=null && r.equals("0")))? false: true;	}		public boolean cambiarEstadoDetalles(String avpcodsx, String nuevoEstado) throws SQLException {		 String cad = "update averia set aveestado = '" + nuevoEstado + "' where avecodaveriapadre = "+ avpcodsx;		 int resp = db.executeUpdate(cad);		return resp == 0 ? false : true;	}		 public boolean tieneDetallesConReparaciones(String avpcodsx) {		 String cad = "select count(1) from reparacion_detalle where repdaveria in (select avecodsx  from averia where avecodaveriapadre = " + avpcodsx + ")";		 String r = getCampo(cad);		 return (r==null || (r!=null && r.equals("0")))? false: true;	 }		public Collection getlistaAveriaDetalles(String avpcodsx) {		 String cad = "select * from averia where avecodaveriapadre = "+ avpcodsx;		 this.classEntidad = averia.class;		 Collection resp = getLista(cad);		 this.classEntidad = averia_padre.class;		 return resp;	}		public String getTotalUnidadesPleg(String avpcodsx) {		String cad = "select sum(avecant_pleg_nac) from averia where avecodaveriapadre = " + avpcodsx;		return getCampo(cad);	}		public String getTotalUnidadesProd(String avpcodsx) {		String cad = "select sum(avecant_prod_nac) from averia where avecodaveriapadre = " + avpcodsx;		return getCampo(cad);	}}